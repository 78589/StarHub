# ç™»å½•é—®é¢˜

æœ¬é¡µä»‹ç» StarHub çš„ç™»å½•ç›¸å…³é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆã€‚

## OAuth ç™»å½•å¤±è´¥

### é—®é¢˜æè¿°

ç‚¹å‡»ã€Œä½¿ç”¨ GitHub ç™»å½•ã€åŽï¼Œè·³è½¬ GitHub æŽˆæƒï¼Œä½†è¿”å›žåŽæ˜¾ç¤ºé”™è¯¯ã€‚

### å¸¸è§åŽŸå› 

1. **å›žè°ƒåœ°å€ä¸åŒ¹é…**
2. **åŽç«¯æœåŠ¡æœªè¿è¡Œ**
3. **Client ID/Secret é…ç½®é”™è¯¯**
4. **ç½‘ç»œé—®é¢˜**

### è§£å†³æ–¹æ¡ˆ

#### æ£€æŸ¥å›žè°ƒåœ°å€

GitHub OAuth App çš„å›žè°ƒåœ°å€å¿…é¡»**å®Œå…¨åŒ¹é…**ï¼š

| çŽ¯å¢ƒ | å›žè°ƒåœ°å€ |
|------|----------|
| æœ¬åœ°å¼€å‘ | `http://localhost:5173/#/login` |
| ç”Ÿäº§çŽ¯å¢ƒ | `https://yourdomain.com/#/login` |

æ³¨æ„ï¼š
- åè®®ï¼ˆhttp/httpsï¼‰å¿…é¡»åŒ¹é…
- ç«¯å£å·å¿…é¡»åŒ¹é…
- è·¯å¾„å¿…é¡»åŒ¹é…

#### æ£€æŸ¥åŽç«¯æœåŠ¡

æœ¬åœ°å¼€å‘æ—¶ï¼Œç¡®ä¿ OAuth ä»£ç†æœåŠ¡å™¨æ­£åœ¨è¿è¡Œï¼š

```bash
node server/dev-server.js
```

æˆåŠŸè¿è¡Œä¼šæ˜¾ç¤ºï¼š
```
ðŸš€ æœ¬åœ°å¼€å‘æœåŠ¡å™¨è¿è¡Œåœ¨ http://localhost:7001
```

#### æ£€æŸ¥é…ç½®æ–‡ä»¶

ç¡®è®¤ `src/config/oauth.ts` ä¸­çš„ `CLIENT_ID` æ­£ç¡®ï¼š

```typescript
export const GITHUB_OAUTH_CONFIG = {
  CLIENT_ID: 'your_actual_client_id'
}
```

ç¡®è®¤ `.env` æ–‡ä»¶å­˜åœ¨ä¸”å†…å®¹æ­£ç¡®ï¼š

```env
CLIENT_ID=your_client_id
CLIENT_SECRET=your_client_secret
```

---

## æŽˆæƒåŽä¸€ç›´åŠ è½½

### é—®é¢˜æè¿°

GitHub æŽˆæƒæˆåŠŸï¼Œè·³è½¬å›ž StarHub åŽé¡µé¢ä¸€ç›´æ˜¾ç¤ºåŠ è½½çŠ¶æ€ã€‚

### è§£å†³æ–¹æ¡ˆ

1. **æ£€æŸ¥æŽ§åˆ¶å°é”™è¯¯**ï¼šæŒ‰ F12 æŸ¥çœ‹æ˜¯å¦æœ‰æŠ¥é”™

2. **æ¸…é™¤ç™»å½•çŠ¶æ€**ï¼š
   ```javascript
   localStorage.removeItem('github_token');
   localStorage.removeItem('access_token');
   location.reload();
   ```

3. **é‡æ–°ç™»å½•**ï¼šæ¸…é™¤åŽåˆ·æ–°é¡µé¢é‡è¯•

---

## Token å¤±æ•ˆ

### é—®é¢˜æè¿°

ä¹‹å‰å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œçªç„¶æ— æ³•èŽ·å–æ•°æ®æˆ–æç¤ºæœªæŽˆæƒã€‚

### åŽŸå› 

- Token è¿‡æœŸ
- åœ¨ GitHub æ’¤é”€äº†æŽˆæƒ
- Token è¢«æ„å¤–æ¸…é™¤

### è§£å†³æ–¹æ¡ˆ

1. **é€€å‡ºé‡æ–°ç™»å½•**ï¼šç‚¹å‡»å¤´åƒ â†’ é€€å‡ºç™»å½• â†’ é‡æ–°ç™»å½•

2. **æ£€æŸ¥ GitHub æŽˆæƒ**ï¼š
   - è®¿é—® https://github.com/settings/applications
   - ç¡®è®¤ StarHub åœ¨å·²æŽˆæƒåˆ—è¡¨ä¸­

3. **æ‰‹åŠ¨æ¸…é™¤é‡æ–°æŽˆæƒ**ï¼š
   ```javascript
   localStorage.clear();
   location.reload();
   ```

---

## è·¨åŸŸé”™è¯¯

### é—®é¢˜æè¿°

æŽ§åˆ¶å°æ˜¾ç¤º CORS ç›¸å…³é”™è¯¯ã€‚

### åŽŸå› 

- åŽç«¯ä»£ç†æœªæ­£ç¡®é…ç½®
- ç”Ÿäº§çŽ¯å¢ƒ Workers/Serverless é…ç½®é—®é¢˜

### è§£å†³æ–¹æ¡ˆ

#### æœ¬åœ°å¼€å‘

ç¡®è®¤ `vite.config.ts` ä¸­ä»£ç†é…ç½®æ­£ç¡®ï¼š

```typescript
proxy: {
  '/api': {
    target: 'http://localhost:7001',
    changeOrigin: true
  }
}
```

#### ç”Ÿäº§çŽ¯å¢ƒ

ç¡®è®¤ Cloudflare Workers æˆ– Serverless Function æ­£ç¡®è¿”å›ž CORS å¤´ï¼š

```typescript
return new Response(JSON.stringify(data), {
  headers: {
    'Content-Type': 'application/json',
    'Access-Control-Allow-Origin': '*'
  }
})
```

---

## ç½‘ç»œè¶…æ—¶

### é—®é¢˜æè¿°

ç™»å½•è¿‡ç¨‹ä¸­æç¤ºç½‘ç»œè¶…æ—¶æˆ–è¿žæŽ¥å¤±è´¥ã€‚

### è§£å†³æ–¹æ¡ˆ

1. **æ£€æŸ¥ç½‘ç»œè¿žæŽ¥**ï¼šç¡®ä¿å¯ä»¥è®¿é—® GitHub

2. **ä½¿ç”¨ä»£ç†**ï¼šå¦‚æžœ GitHub è®¿é—®å—é™ï¼Œé…ç½®ç½‘ç»œä»£ç†

3. **ç¨åŽé‡è¯•**ï¼šGitHub API å¯èƒ½æš‚æ—¶ä¸å¯ç”¨

4. **æ£€æŸ¥é˜²ç«å¢™**ï¼šç¡®ä¿æ²¡æœ‰é˜»æ­¢ç›¸å…³è¯·æ±‚

---

## å¤šè´¦æˆ·åˆ‡æ¢

### é—®é¢˜æè¿°

æƒ³è¦åˆ‡æ¢åˆ°å¦ä¸€ä¸ª GitHub è´¦æˆ·ã€‚

### è§£å†³æ–¹æ¡ˆ

1. ç‚¹å‡»å¤´åƒ â†’ é€€å‡ºç™»å½•
2. åˆ·æ–°é¡µé¢
3. ç‚¹å‡»ç™»å½•ï¼Œåœ¨ GitHub é¡µé¢åˆ‡æ¢è´¦æˆ·
4. æŽˆæƒæ–°è´¦æˆ·

å¦‚æžœ GitHub è‡ªåŠ¨ä½¿ç”¨æ—§è´¦æˆ·ï¼š
1. å…ˆåœ¨ GitHub ç½‘ç«™é€€å‡ºç™»å½•
2. æˆ–åœ¨æŽˆæƒé¡µé¢ç‚¹å‡»ã€ŒUse another accountã€

---

## æƒé™ä¸è¶³

### é—®é¢˜æè¿°

ç™»å½•åŽæ— æ³•èŽ·å–ä»“åº“æ•°æ®ï¼Œæç¤ºæƒé™ä¸è¶³ã€‚

### è§£å†³æ–¹æ¡ˆ

1. **é‡æ–°æŽˆæƒ**ï¼š
   - è®¿é—® https://github.com/settings/applications
   - æ‰¾åˆ° StarHub â†’ Revoke access
   - å›žåˆ° StarHub é‡æ–°ç™»å½•æŽˆæƒ

2. **æ£€æŸ¥ OAuth Scope**ï¼šç¡®ä¿è¯·æ±‚äº†æ­£ç¡®çš„æƒé™èŒƒå›´

StarHub éœ€è¦çš„æƒé™ï¼š
- `read:user` - è¯»å–ç”¨æˆ·ä¿¡æ¯
- `public_repo` - è®¿é—®å…¬å¼€ä»“åº“

---

## è°ƒè¯•æŠ€å·§

### æŸ¥çœ‹è¯·æ±‚è¯¦æƒ…

1. æ‰“å¼€å¼€å‘è€…å·¥å…· (F12)
2. åˆ‡æ¢åˆ° Network æ ‡ç­¾
3. ç­›é€‰ `getToken` è¯·æ±‚
4. æŸ¥çœ‹è¯·æ±‚å’Œå“åº”å†…å®¹

### æŸ¥çœ‹å­˜å‚¨çš„ Token

```javascript
console.log('Token:', localStorage.getItem('access_token'));
console.log('GitHub Token:', localStorage.getItem('github_token'));
```

### æµ‹è¯• API è¿žé€šæ€§

```javascript
fetch('/api/health')
  .then(r => r.json())
  .then(console.log)
  .catch(console.error);
```

